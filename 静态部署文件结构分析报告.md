# Lexicon-webapp é™æ€éƒ¨ç½²æ–‡ä»¶ç»“æ„åˆ†ææŠ¥å‘Š

## é¡¹ç›®æ¦‚å†µ

**é¡¹ç›®åç§°**: lexicon-webapp (è‹±è¯­å­¦ä¹ Webåº”ç”¨)  
**æŠ€æœ¯æ ˆ**: React + Vite + TypeScript + Tailwind CSS + CloudBase  
**éƒ¨ç½²æ–¹å¼**: è…¾è®¯äº‘CloudBaseé™æ€æ‰˜ç®¡

## 1. æ–‡ä»¶ç»“æ„åˆ†æ

### 1.1 æºä»£ç ç›®å½•ç»“æ„
```
src/
â”œâ”€â”€ components/     # ç»„ä»¶ç›®å½•
â”œâ”€â”€ pages/         # é¡µé¢ç»„ä»¶
â”œâ”€â”€ services/      # ä¸šåŠ¡æœåŠ¡å±‚
â”œâ”€â”€ utils/         # å·¥å…·å‡½æ•°
â”œâ”€â”€ contexts/      # React Context
â”œâ”€â”€ types/         # TypeScriptç±»å‹å®šä¹‰
â””â”€â”€ main.tsx       # åº”ç”¨å…¥å£
```

### 1.2 æ„å»ºè¾“å‡ºç›®å½•ç»“æ„ï¼ˆdist/ï¼‰
```
dist/
â”œâ”€â”€ index.html           # ä¸»é¡µé¢æ–‡ä»¶
â”œâ”€â”€ assets/             # CSSèµ„æºæ–‡ä»¶
â”‚   â”œâ”€â”€ index-BEOHtxxd.css (å½“å‰ç‰ˆæœ¬)
â”‚   â””â”€â”€ index-DVETO60k.css (æ—§ç‰ˆæœ¬)
â”œâ”€â”€ js/                 # JavaScriptèµ„æºæ–‡ä»¶
â”‚   â”œâ”€â”€ [é¡µé¢ç»„ä»¶]-[hash].js
â”‚   â””â”€â”€ [å·¥å…·ç»„ä»¶]-[hash].js
â”œâ”€â”€ fonts/              # å­—ä½“æ–‡ä»¶
â”‚   â””â”€â”€ zpix.ttf
â”œâ”€â”€ audioProcessor.js   # éŸ³é¢‘å¤„ç†å™¨
â”œâ”€â”€ test.html          # æµ‹è¯•é¡µé¢
â””â”€â”€ vite.svg           # å›¾æ ‡æ–‡ä»¶
```

### 1.3 publicç›®å½•å¼‚å¸¸æƒ…å†µ
**é—®é¢˜å‘ç°**: publicç›®å½•ä¸‹å­˜åœ¨æ„å»ºäº§ç‰©æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸æ­£å¸¸çš„ï¼š
- `public/js/` ç›®å½•åŒ…å«å¤§é‡å¸¦hashçš„JSæ–‡ä»¶
- `public/assets/` ç›®å½•åŒ…å«CSSæ–‡ä»¶
- `public/index.html` å¼•ç”¨çš„èµ„æºç‰ˆæœ¬ä¸ `dist/index.html` ä¸ä¸€è‡´

## 2. é‡å¤æ–‡ä»¶é—®é¢˜åˆ†æ

### 2.1 é‡å¤æ–‡ä»¶ç»Ÿè®¡
ç»è¿‡åˆ†æå‘ç°ï¼Œdistç›®å½•å­˜åœ¨å¤§é‡é‡å¤çš„æ„å»ºæ–‡ä»¶ï¼š

**ä¸¥é‡é‡å¤çš„æ–‡ä»¶ç±»åˆ«**ï¼š
- AuthPage: 2ä¸ªç‰ˆæœ¬ (AuthPage-A4BHasGK.js, AuthPage-CV65xBZA.js)
- æ‰€æœ‰é¡µé¢ç»„ä»¶éƒ½å­˜åœ¨2ä¸ªç‰ˆæœ¬
- æ‰€æœ‰UIç»„ä»¶éƒ½å­˜åœ¨2ä¸ªç‰ˆæœ¬
- æ€»è®¡68ä¸ªJSæ–‡ä»¶ï¼Œå…¶ä¸­çº¦50%æ˜¯é‡å¤çš„

**æ–‡ä»¶å¤§å°å¯¹æ¯”**ï¼š
- ä¸¤ä¸ªAuthPageæ–‡ä»¶å¤§å°å®Œå…¨ç›¸åŒï¼ˆ24,878å­—èŠ‚ï¼‰
- ä½†å†…éƒ¨å¼•ç”¨çš„ä¾èµ–å“ˆå¸Œä¸åŒï¼Œè¯´æ˜æ˜¯ä¸åŒæ„å»ºé˜¶æ®µçš„äº§ç‰©

### 2.2 é‡å¤äº§ç”ŸåŸå› åˆ†æ

1. **å¤šæ¬¡æ„å»ºæœªæ¸…ç†**ï¼šæ¯æ¬¡æ‰§è¡Œ `npm run build` æ—¶ï¼ŒViteç”Ÿæˆæ–°çš„hashï¼Œä½†æ—§æ–‡ä»¶æœªè¢«æ¸…é™¤
2. **Viteç¼“å­˜é—®é¢˜**ï¼šæ„å»ºè¿‡ç¨‹ä¸­å¯èƒ½å‘ç”Ÿäº†ä¸­æ–­æˆ–é‡å¯ï¼Œå¯¼è‡´äº§ç”Ÿå¤šä»½æ–‡ä»¶
3. **publicç›®å½•æ··æ·†**ï¼špublicç›®å½•é”™è¯¯åœ°åŒ…å«äº†æ„å»ºäº§ç‰©

## 3. é…ç½®æ–‡ä»¶åˆ†æ

### 3.1 vite.config.js é…ç½®è¯„ä¼°

**ä¼˜ç‚¹**ï¼š
```javascript
base: './',                    // âœ… æ­£ç¡®ä½¿ç”¨ç›¸å¯¹è·¯å¾„
chunkFileNames: 'js/[name]-[hash].js',  // âœ… åˆç†çš„æ–‡ä»¶å‘½åè§„åˆ™
assetFileNames: åŠ¨æ€åˆ†ç±»        // âœ… èµ„æºæ–‡ä»¶åˆ†ç±»å­˜æ”¾
```

**æ½œåœ¨é—®é¢˜**ï¼š
- ç¼ºå°‘æ„å»ºå‰æ¸…ç†é…ç½®
- æ²¡æœ‰é…ç½®æ„å»ºäº§ç‰©çš„å»é‡æœºåˆ¶

### 3.2 cloudbaserc.json é…ç½®è¯„ä¼°

**å½“å‰é…ç½®**ï¼š
```json
{
  "envId": "cloud1-7g7oatv381500c81",
  "framework": {
    "plugins": {
      "client": {
        "buildCommand": "npm run build",
        "outputPath": "dist",
        "cloudPath": "/lexicon-webapp"    // âœ… éƒ¨ç½²åˆ°å­ç›®å½•
      }
    }
  },
  "hosting": {
    "public": "dist",                     // âœ… æ­£ç¡®æŒ‡å‘æ„å»ºç›®å½•
    "ignore": ["node_modules/**/*", ".git/**/*"]
  }
}
```

**é…ç½®åˆç†æ€§**: æ•´ä½“é…ç½®æ­£ç¡®ï¼Œéƒ¨ç½²è·¯å¾„æ˜ç¡®

## 4. ç°å­˜é—®é¢˜æ€»ç»“

### 4.1 ä¸¥é‡é—®é¢˜
1. **æ–‡ä»¶é‡å¤**: distç›®å½•å­˜åœ¨å¤§é‡é‡å¤çš„æ„å»ºæ–‡ä»¶ï¼Œæµªè´¹å­˜å‚¨ç©ºé—´
2. **publicç›®å½•æ±¡æŸ“**: publicç›®å½•åŒ…å«æ„å»ºäº§ç‰©ï¼Œè¿åäº†å‰ç«¯é¡¹ç›®æ ‡å‡†ç»“æ„
3. **ç‰ˆæœ¬æ··æ·†**: ä¸åŒç‰ˆæœ¬çš„æ–‡ä»¶å¯èƒ½å¯¼è‡´è¿è¡Œæ—¶ä¸ä¸€è‡´

### 4.2 ä¸­ç­‰é—®é¢˜
1. **æ„å»ºç¼“å­˜ç®¡ç†**: ç¼ºå°‘æ„å»ºå‰æ¸…ç†æœºåˆ¶
2. **æ–‡ä»¶ç»„ç»‡**: é™æ€èµ„æºå’Œæ„å»ºäº§ç‰©æ··åˆå­˜æ”¾

### 4.3 æ½œåœ¨é£é™©
1. **éƒ¨ç½²ä¸ä¸€è‡´**: publicå’Œdistç›®å½•çš„HTMLæ–‡ä»¶å¼•ç”¨ä¸åŒç‰ˆæœ¬çš„èµ„æº
2. **CDNç¼“å­˜é—®é¢˜**: é‡å¤æ–‡ä»¶å¯èƒ½å¯¼è‡´CDNç¼“å­˜ç­–ç•¥å¤±æ•ˆ

## 5. æ”¹è¿›å»ºè®®

### 5.1 ç«‹å³å¤„ç†å»ºè®®

#### A. æ¸…ç†é‡å¤æ–‡ä»¶
```bash
# æ¸…ç†distç›®å½•å¹¶é‡æ–°æ„å»º
rm -rf dist/
npm run build
```

#### B. æ¸…ç†publicç›®å½•
```bash
# åˆ é™¤publicç›®å½•ä¸­çš„æ„å»ºäº§ç‰©
rm -rf public/js/
rm -rf public/assets/
rm public/index.html
```

#### C. æ›´æ–°æ„å»ºè„šæœ¬
```json
{
  "scripts": {
    "clean": "rm -rf dist/",
    "build": "npm run clean && vite build",
    "preview": "vite preview"
  }
}
```

### 5.2 é…ç½®ä¼˜åŒ–å»ºè®®

#### A. æ›´æ–°vite.config.js
```javascript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import path from 'path'

export default defineConfig({
  plugins: [react()],
  base: './',
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src')
    }
  },
  build: {
    outDir: 'dist',
    assetsDir: 'assets',
    sourcemap: false,
    emptyOutDir: true,  // âœ… æ·»åŠ ï¼šæ„å»ºå‰æ¸…ç©ºè¾“å‡ºç›®å½•
    target: 'es2015',
    minify: 'esbuild',
    rollupOptions: {
      output: {
        chunkFileNames: 'js/[name]-[hash].js',
        entryFileNames: 'js/[name]-[hash].js',
        assetFileNames: (assetInfo) => {
          const info = assetInfo.name.split('.');
          const ext = info[info.length - 1];
          if (/\.(png|jpe?g|gif|svg|webp|ico)$/.test(assetInfo.name)) {
            return `img/[name]-[hash].${ext}`;
          }
          if (/\.(woff2?|eot|ttf|otf)$/.test(assetInfo.name)) {
            return `fonts/[name]-[hash].${ext}`;
          }
          return `assets/[name]-[hash].${ext}`;
        }
      }
    }
  }
})
```

### 5.3 éƒ¨ç½²è§„åˆ™ä¼˜åŒ–

#### A. åˆ›å»ºéƒ¨ç½²å‰æ¸…ç†è„šæœ¬
```bash
#!/bin/bash
# deploy-clean.sh

echo "ğŸ§¹ æ¸…ç†æœ¬åœ°æ„å»ºäº§ç‰©..."
rm -rf dist/

echo "ğŸ”¨ é‡æ–°æ„å»º..."
npm run build

echo "ğŸ“¦ å‡†å¤‡éƒ¨ç½²..."
# å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ å…¶ä»–éƒ¨ç½²å‰æ£€æŸ¥
```

#### B. æ›´æ–°cloudbaserc.json
```json
{
  "$schema": "https://framework-1258016615.tcloudbaseapp.com/schema/latest.json",
  "version": "2.0",
  "envId": "cloud1-7g7oatv381500c81",
  "framework": {
    "name": "lexicon-webapp",
    "plugins": {
      "client": {
        "use": "@cloudbase/framework-plugin-website",
        "inputs": {
          "buildCommand": "npm run clean && npm run build",
          "outputPath": "dist",
          "cloudPath": "/lexicon-webapp",
          "ignore": [
            ".DS_Store",
            "node_modules/**/*",
            "src/**/*",
            "public/**/*"
          ]
        }
      }
    }
  }
}
```

### 5.4 è§„èŒƒåŒ–éƒ¨ç½²æµç¨‹

#### A. æ ‡å‡†éƒ¨ç½²æµç¨‹
```bash
# 1. æ¸…ç†ç¯å¢ƒ
npm run clean

# 2. å®‰è£…ä¾èµ–
npm install

# 3. æ„å»ºé¡¹ç›®
npm run build

# 4. æœ¬åœ°é¢„è§ˆæµ‹è¯•
npm run preview

# 5. éƒ¨ç½²åˆ°äº‘ç«¯
tcb hosting deploy dist/ /lexicon-webapp -e cloud1-7g7oatv381500c81
```

#### B. éƒ¨ç½²éªŒè¯æ£€æŸ¥
```bash
# éªŒè¯æ„å»ºäº§ç‰©
echo "æ£€æŸ¥æ„å»ºäº§ç‰©..."
ls -la dist/
echo "æ–‡ä»¶æ€»æ•°: $(find dist -type f | wc -l)"
echo "é‡å¤æ–‡ä»¶æ£€æŸ¥: $(find dist -name "*.js" | sed 's/-[A-Za-z0-9_-]*\.js$/.js/' | sort | uniq -c | sort -nr | head -5)"
```

## 6. ç›‘æ§å’Œç»´æŠ¤å»ºè®®

### 6.1 å®šæœŸæ£€æŸ¥
1. **æ¯å‘¨æ£€æŸ¥**: æ„å»ºäº§ç‰©æ˜¯å¦æœ‰é‡å¤æ–‡ä»¶
2. **æ¯æœˆæ£€æŸ¥**: CDNç¼“å­˜æ•ˆæœå’Œè®¿é—®æ€§èƒ½
3. **ç‰ˆæœ¬å‘å¸ƒå‰**: å®Œæ•´çš„æ„å»ºå’Œéƒ¨ç½²æµ‹è¯•

### 6.2 è‡ªåŠ¨åŒ–æ”¹è¿›
1. **CI/CDé›†æˆ**: åœ¨æ„å»ºæµç¨‹ä¸­åŠ å…¥é‡å¤æ–‡ä»¶æ£€æµ‹
2. **éƒ¨ç½²é’©å­**: éƒ¨ç½²å‰è‡ªåŠ¨æ¸…ç†æ—§æ–‡ä»¶
3. **ç›‘æ§å‘Šè­¦**: æ„å»ºäº§ç‰©å¼‚å¸¸æ—¶å‘é€é€šçŸ¥

## 7. é£é™©è¯„ä¼°

### 7.1 å½“å‰é£é™©ç­‰çº§ï¼šä¸­ç­‰
- åŠŸèƒ½ä¸å—å½±å“ï¼Œä½†å­˜åœ¨èµ„æºæµªè´¹å’Œæ½œåœ¨ä¸ä¸€è‡´
- éœ€è¦åŠæ—¶æ¸…ç†ï¼Œé¿å…é—®é¢˜ç´¯ç§¯

### 7.2 å»ºè®®å¤„ç†ä¼˜å…ˆçº§
1. **ç«‹å³å¤„ç†**: æ¸…ç†é‡å¤æ–‡ä»¶å’Œpublicç›®å½•
2. **æœ¬å‘¨å†…**: æ›´æ–°æ„å»ºé…ç½®å’Œéƒ¨ç½²è„šæœ¬
3. **ä¸‹ä¸ªç‰ˆæœ¬**: å®æ–½è‡ªåŠ¨åŒ–ç›‘æ§å’Œæ£€æŸ¥æœºåˆ¶

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-07-22  
**åˆ†æå¯¹è±¡**: /home/dministrator/Projects/lexicon-webapp  
**å»ºè®®æ‰§è¡Œäºº**: é¡¹ç›®ç»´æŠ¤äººå‘˜