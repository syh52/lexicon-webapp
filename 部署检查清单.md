# 云开发项目部署检查清单

## 📋 部署前必查项目 (Pre-Deployment Checklist)

### 🔧 配置文件检查
- [ ] **路径配置一致性**
  - [ ] `vite.config.js` 的 `base` 配置
  - [ ] `cloudbaserc.json` 的 `cloudPath` 配置  
  - [ ] 两者配置是否一致 ⚠️ **这是最重要的检查项**

- [ ] **环境变量配置**
  - [ ] 所有云函数的环境变量已设置
  - [ ] API密钥格式正确
  - [ ] 敏感信息不在代码中硬编码

- [ ] **构建配置验证**
  - [ ] `package.json` 构建脚本正确
  - [ ] 输出目录 `outputPath` 设置为 `dist`
  - [ ] 构建命令能成功执行

### 🏗️ 构建前检查
- [ ] **依赖安装**
  ```bash
  npm install # 确保所有依赖已安装
  ```

- [ ] **本地构建测试**
  ```bash
  npm run build # 确保构建成功
  ls -la dist/  # 验证构建产物
  ```

- [ ] **代码质量检查**
  - [ ] 没有控制台错误
  - [ ] 没有编译警告（或已知可忽略）
  - [ ] 关键功能本地测试通过

## 🚀 部署执行清单 (Deployment Execution)

### 1️⃣ 云函数部署
- [ ] **批量检查云函数**
  ```bash
  # 使用MCP工具: getFunctionList
  # 确认环境ID: cloud1-7g7oatv381500c81
  ```

- [ ] **重新部署关键云函数**
  - [ ] `speech-recognition` (语音识别)
  - [ ] `ai-chat` (AI对话)
  - [ ] `text-to-speech` (语音合成)
  - [ ] 其他业务关键函数

- [ ] **云函数验证**
  - [ ] 函数状态显示"部署完成"
  - [ ] 环境变量正确设置
  - [ ] 运行时版本正确

### 2️⃣ 静态文件部署
- [ ] **部署路径确认**
  ```bash
  # 根目录部署（推荐）
  localPath: /path/to/dist
  cloudPath: /
  
  # 或子目录部署
  localPath: /path/to/dist  
  cloudPath: /your-app-name
  ```

- [ ] **文件上传验证**
  - [ ] 所有文件上传成功（39个文件）
  - [ ] 无上传失败记录
  - [ ] 文件大小合理

### 3️⃣ 域名和连通性测试
- [ ] **基础连通性**
  ```bash
  curl -I https://cloud1-7g7oatv381500c81-1367168150.tcloudbaseapp.com
  # 期望: HTTP/2 200
  ```

- [ ] **访问地址确认**
  - [ ] 根目录: `https://domain.com/`
  - [ ] 或子目录: `https://domain.com/app-name/`

## ✅ 部署后验证清单 (Post-Deployment Verification)

### 🌐 前端功能验证
- [ ] **基础页面加载**
  - [ ] 主页正常显示
  - [ ] 路由切换正常
  - [ ] 静态资源加载正常

- [ ] **响应式设计**
  - [ ] 桌面端显示正常
  - [ ] 移动端显示正常
  - [ ] 交互功能正常

### ☁️ 云函数功能验证
- [ ] **AI功能测试**
  - [ ] AI对话响应正常
  - [ ] 语音识别功能正常
  - [ ] 文本转语音功能正常

- [ ] **数据库功能**
  - [ ] 用户数据读写正常
  - [ ] 词书管理功能正常
  - [ ] 学习进度记录正常

### 🔍 性能和错误检查
- [ ] **加载性能**
  - [ ] 页面首次加载时间 < 3秒
  - [ ] 资源加载无错误
  - [ ] 控制台无严重错误

- [ ] **错误处理**
  - [ ] 网络错误有友好提示
  - [ ] API调用失败有重试机制
  - [ ] 用户操作有反馈

## 🚨 应急处理清单 (Emergency Procedures)

### 问题：网站无法访问
1. [ ] 检查域名解析状态
2. [ ] 确认静态托管服务状态
3. [ ] 验证部署路径配置
4. [ ] 重新部署到根目录

### 问题：功能异常
1. [ ] 检查浏览器控制台错误
2. [ ] 验证云函数调用状态
3. [ ] 检查API密钥配置
4. [ ] 重新部署对应云函数

### 问题：资源加载失败
1. [ ] 检查CDN缓存状态
2. [ ] 确认资源路径配置
3. [ ] 验证构建产物完整性
4. [ ] 清除缓存重新访问

## 📝 部署记录模板

```markdown
# 部署记录 - [YYYY-MM-DD HH:mm]

## 部署信息
- 环境ID: cloud1-7g7oatv381500c81
- 部署分支: main
- 部署类型: [全量/增量]

## 执行的操作
- [ ] 云函数部署
- [ ] 静态文件部署
- [ ] 配置更新

## 验证结果
- [ ] 基础功能 ✅/❌
- [ ] 云函数功能 ✅/❌  
- [ ] 性能表现 ✅/❌

## 访问地址
- 正式地址: https://cloud1-7g7oatv381500c81-1367168150.tcloudbaseapp.com

## 遇到的问题
1. 问题描述:
   解决方案:
   
2. 问题描述:
   解决方案:

## 下次改进
- [ ] 改进点1
- [ ] 改进点2
```

---

**💡 提示**: 
- 每次部署都要完整执行这个清单
- 遇到问题立即记录解决方案
- 定期更新清单内容
- 团队成员都要熟悉这个流程