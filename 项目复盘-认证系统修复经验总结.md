# é¡¹ç›®å¤ç›˜ï¼šè®¤è¯ç³»ç»Ÿä¿®å¤ç»éªŒæ€»ç»“

## ğŸ“Š é¡¹ç›®æ¦‚å†µ

**é¡¹ç›®åç§°**ï¼šLexicon WebApp è®¤è¯ç³»ç»Ÿä¿®å¤  
**ç›®æ ‡**ï¼šä¿®å¤æ³¨å†Œç™»å½•ç³»ç»Ÿï¼Œç§»é™¤åŒ¿åç™»å½•åŠŸèƒ½ï¼Œæ„å»ºçº¯é‚®ç®±è®¤è¯ç³»ç»Ÿ  
**ç»“æœ**ï¼šâœ… å®Œå…¨æˆåŠŸï¼Œç³»ç»Ÿæ­£å¸¸è¿è¡Œ  
**è€—æ—¶**ï¼šçº¦1å°æ—¶ï¼Œå®Œæˆ9ä¸ªä¸»è¦ä»»åŠ¡  
**éƒ¨ç½²åœ°å€**ï¼š[https://cloud1-7g7oatv381500c81-1367168150.tcloudbaseapp.com/](https://cloud1-7g7oatv381500c81-1367168150.tcloudbaseapp.com/)

## ğŸ¯ æˆåŠŸç»éªŒ

### 1. **è®¡åˆ’é©±åŠ¨çš„å¼€å‘æµç¨‹**

- âœ… ä½¿ç”¨ `exit_plan_mode` å·¥å…·ä¸ç”¨æˆ·ç¡®è®¤è®¡åˆ’åå†æ‰§è¡Œ
- âœ… ä½¿ç”¨ `TodoWrite` å·¥å…·è·Ÿè¸ªä»»åŠ¡è¿›åº¦ï¼Œå®æ—¶æ›´æ–°çŠ¶æ€
- âœ… ä»»åŠ¡åˆ†è§£æ¸…æ™°ï¼šUIå±‚ â†’ ä¸šåŠ¡é€»è¾‘å±‚ â†’ æ•°æ®å±‚ â†’ éƒ¨ç½²æµ‹è¯•

**æœ€ä½³å®è·µ**ï¼š
```markdown
1. åˆ†æç°æœ‰æ¶æ„
2. åˆ¶å®šè¯¦ç»†è®¡åˆ’
3. ç”¨æˆ·ç¡®è®¤æ–¹æ¡ˆ
4. æŒ‰ä¼˜å…ˆçº§æ‰§è¡Œ
5. å®æ—¶æ›´æ–°è¿›åº¦
```

### 2. **æœ‰æ•ˆçš„é—®é¢˜è¯Šæ–­æ–¹æ³•**

- âœ… å…ˆè¯»å–ç›¸å…³æ–‡ä»¶äº†è§£ç°æœ‰æ¶æ„
- âœ… ä½¿ç”¨æµè§ˆå™¨è‡ªåŠ¨åŒ–å®æ—¶æµ‹è¯•å‘ç°é—®é¢˜
- âœ… åˆ©ç”¨ `mcp__cloudbase__getFunctionLogs` æŸ¥çœ‹äº‘å‡½æ•°æ—¥å¿—è¯Šæ–­é—®é¢˜
- âœ… é€šè¿‡é”™è¯¯ä¿¡æ¯å¿«é€Ÿå®šä½æ ¹æœ¬åŸå› ï¼ˆ"you can't request without auth"ï¼‰

**è¯Šæ–­å·¥å…·é“¾**ï¼š
```
å‰ç«¯é”™è¯¯ â†’ æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿— â†’ äº‘å‡½æ•°æ—¥å¿— â†’ æ•°æ®åº“çŠ¶æ€
```

### 3. **çµæ´»ä½¿ç”¨ MCP å·¥å…·**

| å·¥å…· | ç”¨é€” | å…³é”®ä½œç”¨ |
|------|------|----------|
| `mcp__cloudbase__updateFunctionCode` | äº‘å‡½æ•°éƒ¨ç½² | å¿«é€Ÿéƒ¨ç½²ä¿®å¤åçš„äº‘å‡½æ•° |
| `mcp__cloudbase__uploadFiles` | é™æ€æ‰˜ç®¡éƒ¨ç½² | è‡ªåŠ¨åŒ–å‰ç«¯éƒ¨ç½² |
| `mcp__cloudbase__getFunctionLogs` | æ—¥å¿—æŸ¥è¯¢ | å®æ—¶é—®é¢˜è¯Šæ–­ |
| `mcp__browser__*` | æµè§ˆå™¨æµ‹è¯• | ç«¯åˆ°ç«¯åŠŸèƒ½éªŒè¯ |

## ğŸ”„ éœ€è¦æ”¹è¿›çš„æ“ä½œ

### 1. **åˆæœŸè®¤è¯ç­–ç•¥å†³ç­–**

**âŒ é—®é¢˜**ï¼šæœ€åˆå®Œå…¨ç§»é™¤äº†CloudBaseåŒ¿åç™»å½•ï¼Œå¯¼è‡´äº‘å‡½æ•°è°ƒç”¨æƒé™é—®é¢˜  
**âœ… æ”¹è¿›**ï¼šåº”è¯¥å…ˆåˆ†æäº‘å‡½æ•°è°ƒç”¨æƒé™éœ€æ±‚ï¼Œå†å†³å®šæ˜¯å¦å®Œå…¨ç§»é™¤åŒ¿åç™»å½•

**å»ºè®®æµç¨‹**ï¼š
```mermaid
graph LR
    A[åˆ†æç°æœ‰æ¶æ„] --> B[äº†è§£ä¾èµ–å…³ç³»]
    B --> C[åˆ¶å®šæ¸è¿›å¼ä¿®æ”¹ç­–ç•¥]
    C --> D[å®æ–½ä¿®æ”¹]
```

### 2. **æµ‹è¯•ç­–ç•¥ä¼˜åŒ–**

**å½“å‰æµç¨‹**ï¼š
```
ä»£ç ä¿®æ”¹ â†’ éƒ¨ç½² â†’ æµ‹è¯• â†’ å‘ç°é—®é¢˜ â†’ ä¿®å¤ â†’ é‡æ–°éƒ¨ç½²
```

**ä¼˜åŒ–æµç¨‹**ï¼š
```
æ¶æ„åˆ†æ â†’ æƒé™æ¢³ç† â†’ å°èŒƒå›´æµ‹è¯• â†’ åˆ†æ­¥ä¿®æ”¹ â†’ éªŒè¯ â†’ å…¨é‡éƒ¨ç½²
```

**å»ºè®®æ­¥éª¤**ï¼š
1. å…ˆç”¨ `mcp__cloudbase__collectionQuery` æŸ¥è¯¢æ•°æ®åº“ç»“æ„
2. åˆ†æäº‘å‡½æ•°é—´çš„è°ƒç”¨å…³ç³»
3. ç†è§£CloudBaseæƒé™æ¨¡å‹åå†è¿›è¡Œä¿®æ”¹

### 3. **é”™è¯¯å¤„ç†æœºåˆ¶**

**âŒ é—®é¢˜**ï¼šå‰ç«¯æ²¡æœ‰æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œåªèƒ½é€šè¿‡æ§åˆ¶å°å’Œäº‘å‡½æ•°æ—¥å¿—å‘ç°é—®é¢˜  
**âœ… æ”¹è¿›**ï¼šåœ¨è®¤è¯ç³»ç»Ÿä¸­åŠ å¼ºé”™è¯¯ä¿¡æ¯çš„å‰ç«¯å±•ç¤º

## ğŸ’¡ æ ¸å¿ƒç»éªŒæ€»ç»“

### æŠ€æœ¯å±‚é¢

#### CloudBaseè®¤è¯æ¨¡å‹ç†è§£
```javascript
// æ­£ç¡®çš„æ··åˆè®¤è¯ç­–ç•¥
const authenticate = async (email, password) => {
  // 1. CloudBaseåŒ¿åç™»å½•ï¼ˆè·å–è°ƒç”¨æƒé™ï¼‰
  await auth.signInAnonymously();
  
  // 2. è‡ªå®šä¹‰é‚®ç®±è®¤è¯ï¼ˆä¸šåŠ¡éªŒè¯ï¼‰
  const result = await app.callFunction({
    name: 'auth-new',
    data: { action: 'login', email, password }
  });
  
  // 3. æœ¬åœ°çŠ¶æ€ç®¡ç†
  localStorage.setItem('user', JSON.stringify(result.data));
};
```

#### å…³é”®æŠ€æœ¯è¦ç‚¹
1. **CloudBaseè®¤è¯æ¨¡å‹**ï¼šå³ä½¿ä½¿ç”¨è‡ªå®šä¹‰é‚®ç®±è®¤è¯ï¼Œä»éœ€CloudBaseåŒ¿åç™»å½•è·å–äº‘å‡½æ•°è°ƒç”¨æƒé™
2. **æ··åˆè®¤è¯ç­–ç•¥**ï¼šCloudBaseåŒ¿åç™»å½•ï¼ˆæƒé™å±‚ï¼‰+ è‡ªå®šä¹‰é‚®ç®±è®¤è¯ï¼ˆä¸šåŠ¡å±‚ï¼‰
3. **MCPå·¥å…·é“¾**ï¼šåœ¨äº‘å¼€å‘é¡¹ç›®ä¸­æå¤§æé«˜äº†å¼€å‘æ•ˆç‡

### æµç¨‹å±‚é¢

1. **è®¡åˆ’ç¡®è®¤æœºåˆ¶**ï¼šç”¨æˆ·ç¡®è®¤è®¡åˆ’åå†æ‰§è¡Œé¿å…äº†æ–¹å‘æ€§é”™è¯¯
2. **å®æ—¶æµ‹è¯•åé¦ˆ**ï¼šæµè§ˆå™¨è‡ªåŠ¨åŒ–æµ‹è¯•æä¾›äº†å³æ—¶çš„åŠŸèƒ½éªŒè¯
3. **æ—¥å¿—é©±åŠ¨è°ƒè¯•**ï¼šäº‘å‡½æ•°æ—¥å¿—æ˜¯è¯Šæ–­åç«¯é—®é¢˜çš„å…³é”®å·¥å…·

### æ²Ÿé€šå±‚é¢

1. **éœ€æ±‚æ¾„æ¸…**ï¼šåŠæ—¶ç¡®è®¤ç”¨æˆ·éœ€æ±‚ï¼ˆç§»é™¤åŒ¿åç™»å½•ã€ç®€åŒ–éªŒè¯ï¼‰é¿å…äº†è¿‡åº¦è®¾è®¡
2. **è¿›åº¦é€æ˜**ï¼šä½¿ç”¨todoå·¥å…·è®©ç”¨æˆ·æ¸…æ¥šäº†è§£é¡¹ç›®è¿›å±•

## ğŸš€ ä¸‹æ¬¡é¡¹ç›®ä¼˜åŒ–å»ºè®®

### å‰æœŸå‡†å¤‡ï¼ˆ5-10åˆ†é’Ÿï¼‰

#### æ¶æ„åˆ†ææ¸…å•
- [ ] å…¨é¢äº†è§£ç°æœ‰ç³»ç»Ÿçš„è®¤è¯æµç¨‹å’Œä¾èµ–å…³ç³»
- [ ] æ˜ç¡®CloudBaseçš„æƒé™æ¨¡å‹å’Œäº‘å‡½æ•°è°ƒç”¨éœ€æ±‚  
- [ ] ä½¿ç”¨MCPå·¥å…·æŸ¥è¯¢ç°æœ‰æ•°æ®åº“ç»“æ„
- [ ] æ¢³ç†ç°æœ‰ç”¨æˆ·æ•°æ®æ¨¡å‹å’Œå­—æ®µæ˜ å°„å…³ç³»

#### å‡†å¤‡å‘½ä»¤æ¨¡æ¿
```bash
# æ•°æ®åº“ç»“æ„æŸ¥è¯¢
mcp__cloudbase__collectionQuery --action=list

# äº‘å‡½æ•°åˆ—è¡¨æŸ¥è¯¢  
mcp__cloudbase__getFunctionList

# ç¯å¢ƒä¿¡æ¯æŸ¥è¯¢
mcp__cloudbase__envQuery --action=info
```

### å¼€å‘æµç¨‹ä¼˜åŒ–

#### æ¸è¿›å¼ä¿®æ”¹ç­–ç•¥
1. **é˜¶æ®µ1**ï¼šUIå±‚ä¿®æ”¹ï¼ˆç§»é™¤åŒ¿åç™»å½•æŒ‰é’®ï¼‰
2. **é˜¶æ®µ2**ï¼šä¸šåŠ¡é€»è¾‘è°ƒæ•´ï¼ˆä¿ç•™CloudBaseåŒ¿åç™»å½•ä½œä¸ºæƒé™å±‚ï¼‰
3. **é˜¶æ®µ3**ï¼šæ•°æ®æ¨¡å‹ç»Ÿä¸€ï¼ˆç¡®ä¿äº‘å‡½æ•°è¿”å›ä¸€è‡´çš„ç”¨æˆ·ç»“æ„ï¼‰
4. **é˜¶æ®µ4**ï¼šéƒ¨ç½²éªŒè¯ï¼ˆåˆ†åˆ«éƒ¨ç½²äº‘å‡½æ•°å’Œå‰ç«¯ï¼‰

#### æµ‹è¯•å…ˆè¡ŒåŸåˆ™
```markdown
å°èŒƒå›´æµ‹è¯• â†’ éªŒè¯æ–¹æ¡ˆå¯è¡Œæ€§ â†’ åˆ†æ­¥å®æ–½ â†’ æ¯æ­¥éªŒè¯ â†’ å…¨é‡éƒ¨ç½²
```

### å·¥å…·ä½¿ç”¨æœ€ä½³å®è·µ

#### æ‰¹é‡æ“ä½œææ•ˆ
```javascript
// å¹¶è¡Œè°ƒç”¨å¤šä¸ªMCPå·¥å…·
Promise.all([
  mcp__cloudbase__getFunctionLogs(),
  mcp__cloudbase__collectionQuery(),
  mcp__browser__get_screenshot()
]);
```

#### å…³é”®ç›‘æ§ç‚¹
- **å®æ—¶æ—¥å¿—ç›‘æ§**ï¼šäº‘å‡½æ•°æ‰§è¡ŒçŠ¶æ€
- **å‰ç«¯çŠ¶æ€ç›‘æ§**ï¼šç”¨æˆ·è®¤è¯çŠ¶æ€å˜åŒ–
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šä½¿ç”¨æŸ¥è¯¢å‚æ•°é¿å…ç¼“å­˜é—®é¢˜

## ğŸ“ˆ é¡¹ç›®æˆæœè¯„ä¼°

### æŠ€æœ¯å€ºåŠ¡æ¸…ç†
- âœ… ç§»é™¤äº†ä¸å®‰å…¨çš„base64å¯†ç ç¼–ç 
- âœ… ç»Ÿä¸€äº†ç”¨æˆ·æ•°æ®æ¨¡å‹ï¼ˆä½¿ç”¨ä¸€è‡´çš„å­—æ®µåï¼‰
- âœ… æ¸…ç†äº†é‡å¤å’Œå†—ä½™çš„è®¤è¯é€»è¾‘

### æ¶æ„ä¼˜åŒ–
- âœ… ç®€åŒ–äº†è®¤è¯æµç¨‹ï¼Œç§»é™¤äº†æ··ä¹±çš„åŒé‡è®¤è¯é€»è¾‘
- âœ… å»ºç«‹äº†æ¸…æ™°çš„æƒé™åˆ†å±‚ï¼šCloudBaseæƒé™å±‚ + ä¸šåŠ¡è®¤è¯å±‚
- âœ… ä½¿ç”¨æœ¬åœ°å­˜å‚¨ç»Ÿä¸€ç®¡ç†ç”¨æˆ·çŠ¶æ€

### ç”¨æˆ·ä½“éªŒæå‡
- âœ… ç®€åŒ–äº†UIï¼Œç§»é™¤äº†å®¹æ˜“æ··æ·†çš„æ¸¸å®¢æ¨¡å¼
- âœ… å¼ºåŒ–äº†å®‰å…¨æ€§ï¼Œå¿…é¡»æ³¨å†Œåæ‰èƒ½ä½¿ç”¨åº”ç”¨
- âœ… ç»Ÿä¸€äº†ç™»å½•åçš„ç”¨æˆ·ä½“éªŒ

### å¯ç»´æŠ¤æ€§æ”¹å–„
- âœ… ä»£ç ç»“æ„æ›´æ¸…æ™°ï¼Œè®¤è¯é€»è¾‘æ›´ç»Ÿä¸€
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- âœ… è¯¦ç»†çš„é¡¹ç›®æ–‡æ¡£å’Œå¤ç›˜æ€»ç»“

## ğŸ”§ æŠ€æœ¯æ–¹æ¡ˆæ¨¡æ¿

### CloudBase + è‡ªå®šä¹‰è®¤è¯æœ€ä½³å®è·µ

```typescript
// AuthContext.tsx - æ¨èå®ç°æ¨¡å¼
interface AuthContextType {
  user: User | null;
  isLoading: boolean;
  login: (email: string, password: string) => Promise<void>;
  register: (email: string, password: string) => Promise<void>;
  logout: () => Promise<void>;
  isLoggedIn: boolean;
}

const AuthProvider = ({ children }) => {
  const [user, setUser] = useState<User | null>(null);
  const [isLoggedIn, setIsLoggedIn] = useState(false);

  // åˆå§‹åŒ–æ—¶æ£€æŸ¥æœ¬åœ°å­˜å‚¨
  useEffect(() => {
    const storedUser = localStorage.getItem('lexicon_user');
    if (storedUser) {
      setUser(JSON.parse(storedUser));
      setIsLoggedIn(true);
    }
  }, []);

  const login = async (email: string, password: string) => {
    // 1. CloudBaseåŒ¿åç™»å½•è·å–è°ƒç”¨æƒé™
    const auth = app.auth();
    await auth.signInAnonymously();
    
    // 2. è‡ªå®šä¹‰ä¸šåŠ¡è®¤è¯
    const result = await app.callFunction({
      name: 'auth-new',
      data: { action: 'login', email, password }
    });
    
    // 3. æœ¬åœ°çŠ¶æ€ç®¡ç†
    if (result.result?.success) {
      const userData = result.result.data;
      setUser(userData);
      setIsLoggedIn(true);
      localStorage.setItem('lexicon_user', JSON.stringify(userData));
    }
  };
  
  // ... å…¶ä»–æ–¹æ³•å®ç°
};
```

### äº‘å‡½æ•°æƒé™é…ç½®

```javascript
// cloudfunctions/auth-new/index.js
exports.main = async (event, context) => {
  const { action, email, password } = event;
  
  try {
    switch (action) {
      case 'register':
        return await handleRegister(email, password);
      case 'login':
        return await handleLogin(email, password);
      default:
        return { success: false, error: 'æœªçŸ¥æ“ä½œç±»å‹' };
    }
  } catch (error) {
    return { success: false, error: error.message };
  }
};
```

## ğŸ“š ç›¸å…³èµ„æº

- [CloudBaseå®˜æ–¹æ–‡æ¡£](https://cloud.tencent.com/document/product/876)
- [MCPå·¥å…·ä½¿ç”¨æŒ‡å—](./MCP-CloudBaseä½¿ç”¨æŒ‡å—.md)
- [é¡¹ç›®éƒ¨ç½²è¯´æ˜](./README.md)

## ğŸ† æ€»ç»“

è¿™æ¬¡é¡¹ç›®å¾ˆå¥½åœ°å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨MCPå·¥å…·é“¾å’ŒCloudBaseè¿›è¡Œé«˜æ•ˆçš„å…¨æ ˆå¼€å‘ã€‚é€šè¿‡åˆç†çš„è®¡åˆ’åˆ¶å®šã€é—®é¢˜è¯Šæ–­å’Œå·¥å…·ä½¿ç”¨ï¼Œæˆ‘ä»¬åœ¨1å°æ—¶å†…å®Œæˆäº†å¤æ‚çš„è®¤è¯ç³»ç»Ÿé‡æ„ï¼Œä¸ºåç»­ç±»ä¼¼é¡¹ç›®æä¾›äº†å®è´µçš„ç»éªŒå’Œå¯å¤ç”¨çš„æŠ€æœ¯æ–¹æ¡ˆã€‚

**æ ¸å¿ƒæ”¶è·**ï¼š
1. **è®¡åˆ’å…ˆè¡Œ**ï¼šè¯¦ç»†çš„è®¡åˆ’å’Œç”¨æˆ·ç¡®è®¤é¿å…äº†è¿”å·¥
2. **å·¥å…·èµ‹èƒ½**ï¼šMCPå·¥å…·é“¾å¤§å¤§æé«˜äº†å¼€å‘å’Œè°ƒè¯•æ•ˆç‡  
3. **æ¸è¿›å¼æ”¹è¿›**ï¼šåˆ†æ­¥ä¿®æ”¹é™ä½äº†é£é™©ï¼Œæé«˜äº†æˆåŠŸç‡
4. **å®æ—¶éªŒè¯**ï¼šæµè§ˆå™¨è‡ªåŠ¨åŒ–æµ‹è¯•æä¾›äº†å³æ—¶åé¦ˆ

è¿™äº›ç»éªŒå°†æŒ‡å¯¼æˆ‘ä»¬åœ¨æœªæ¥çš„CloudBaseé¡¹ç›®ä¸­æ›´åŠ é«˜æ•ˆå’Œç¨³å®šåœ°è¿›è¡Œå¼€å‘ã€‚